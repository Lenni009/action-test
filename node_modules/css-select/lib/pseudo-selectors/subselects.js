"use strict";var __spreadArray=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var s,a=0,o=t.length;a<o;a++)!s&&a in t||(s||(s=Array.prototype.slice.call(t,0,a)),s[a]=t[a]);return e.concat(s||Array.prototype.slice.call(t))},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.subselects=exports.getNextSiblings=exports.ensureIsTag=exports.PLACEHOLDER_ELEMENT=void 0;var boolbase_1=__importDefault(require("boolbase")),sort_js_1=require("../sort.js");function ensureIsTag(e,t){return e===boolbase_1.default.falseFunc?boolbase_1.default.falseFunc:function(r){return t.isTag(r)&&e(r)}}function getNextSiblings(e,t){var r=t.getSiblings(e);if(r.length<=1)return[];var s=r.indexOf(e);return s<0||s===r.length-1?[]:r.slice(s+1).filter(t.isTag)}function copyOptions(e){return{xmlMode:!!e.xmlMode,lowerCaseAttributeNames:!!e.lowerCaseAttributeNames,lowerCaseTags:!!e.lowerCaseTags,quirksMode:!!e.quirksMode,cacheResults:!!e.cacheResults,pseudos:e.pseudos,adapter:e.adapter,equals:e.equals}}exports.PLACEHOLDER_ELEMENT={},exports.ensureIsTag=ensureIsTag,exports.getNextSiblings=getNextSiblings;var is=function(e,t,r,s,a){var o=a(t,copyOptions(r),s);return o===boolbase_1.default.trueFunc?e:o===boolbase_1.default.falseFunc?boolbase_1.default.falseFunc:function(t){return o(t)&&e(t)}};exports.subselects={is:is,matches:is,where:is,not:function(e,t,r,s,a){var o=a(t,copyOptions(r),s);return o===boolbase_1.default.falseFunc?e:o===boolbase_1.default.trueFunc?boolbase_1.default.falseFunc:function(t){return!o(t)&&e(t)}},has:function(e,t,r,s,a){var o=r.adapter,n=copyOptions(r);n.relativeSelector=!0;var u=t.some((function(e){return e.some(sort_js_1.isTraversal)}))?[exports.PLACEHOLDER_ELEMENT]:void 0,l=a(t,n,u);if(l===boolbase_1.default.falseFunc)return boolbase_1.default.falseFunc;var i=ensureIsTag(l,o);if(u&&l!==boolbase_1.default.trueFunc){var c=l.shouldTestNextSiblings,f=void 0!==c&&c;return function(t){if(!e(t))return!1;u[0]=t;var r=o.getChildren(t),s=f?__spreadArray(__spreadArray([],r,!0),getNextSiblings(t,o),!0):r;return o.existsOne(i,s)}}return function(t){return e(t)&&o.existsOne(i,o.getChildren(t))}}};
