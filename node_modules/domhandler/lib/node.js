"use strict";var __extends=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},__assign.apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.cloneNode=exports.hasChildren=exports.isDocument=exports.isDirective=exports.isComment=exports.isText=exports.isCDATA=exports.isTag=exports.Element=exports.Document=exports.CDATA=exports.NodeWithChildren=exports.ProcessingInstruction=exports.Comment=exports.Text=exports.DataNode=exports.Node=void 0;var domelementtype_1=require("domelementtype"),Node=function(){function e(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}return Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.parent},set:function(e){this.parent=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return this.prev},set:function(e){this.prev=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return this.next},set:function(e){this.next=e},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(e){return void 0===e&&(e=!1),cloneNode(this,e)},e}();exports.Node=Node;var DataNode=function(e){function t(t){var n=e.call(this)||this;return n.data=t,n}return __extends(t,e),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.data},set:function(e){this.data=e},enumerable:!1,configurable:!0}),t}(Node);exports.DataNode=DataNode;var Text=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=domelementtype_1.ElementType.Text,t}return __extends(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 3},enumerable:!1,configurable:!0}),t}(DataNode);exports.Text=Text;var Comment=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=domelementtype_1.ElementType.Comment,t}return __extends(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 8},enumerable:!1,configurable:!0}),t}(DataNode);exports.Comment=Comment;var ProcessingInstruction=function(e){function t(t,n){var r=e.call(this,n)||this;return r.name=t,r.type=domelementtype_1.ElementType.Directive,r}return __extends(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),t}(DataNode);exports.ProcessingInstruction=ProcessingInstruction;var NodeWithChildren=function(e){function t(t){var n=e.call(this)||this;return n.children=t,n}return __extends(t,e),Object.defineProperty(t.prototype,"firstChild",{get:function(){var e;return null!==(e=this.children[0])&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.children},set:function(e){this.children=e},enumerable:!1,configurable:!0}),t}(Node);exports.NodeWithChildren=NodeWithChildren;var CDATA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=domelementtype_1.ElementType.CDATA,t}return __extends(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 4},enumerable:!1,configurable:!0}),t}(NodeWithChildren);exports.CDATA=CDATA;var Document=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=domelementtype_1.ElementType.Root,t}return __extends(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 9},enumerable:!1,configurable:!0}),t}(NodeWithChildren);exports.Document=Document;var Element=function(e){function t(t,n,r,o){void 0===r&&(r=[]),void 0===o&&(o="script"===t?domelementtype_1.ElementType.Script:"style"===t?domelementtype_1.ElementType.Style:domelementtype_1.ElementType.Tag);var i=e.call(this,r)||this;return i.name=t,i.attribs=n,i.type=o,i}return __extends(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tagName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"attributes",{get:function(){var e=this;return Object.keys(this.attribs).map((function(t){var n,r;return{name:t,value:e.attribs[t],namespace:null===(n=e["x-attribsNamespace"])||void 0===n?void 0:n[t],prefix:null===(r=e["x-attribsPrefix"])||void 0===r?void 0:r[t]}}))},enumerable:!1,configurable:!0}),t}(NodeWithChildren);function isTag(e){return(0,domelementtype_1.isTag)(e)}function isCDATA(e){return e.type===domelementtype_1.ElementType.CDATA}function isText(e){return e.type===domelementtype_1.ElementType.Text}function isComment(e){return e.type===domelementtype_1.ElementType.Comment}function isDirective(e){return e.type===domelementtype_1.ElementType.Directive}function isDocument(e){return e.type===domelementtype_1.ElementType.Root}function hasChildren(e){return Object.prototype.hasOwnProperty.call(e,"children")}function cloneNode(e,t){var n;if(void 0===t&&(t=!1),isText(e))n=new Text(e.data);else if(isComment(e))n=new Comment(e.data);else if(isTag(e)){var r=t?cloneChildren(e.children):[],o=new Element(e.name,__assign({},e.attribs),r);r.forEach((function(e){return e.parent=o})),null!=e.namespace&&(o.namespace=e.namespace),e["x-attribsNamespace"]&&(o["x-attribsNamespace"]=__assign({},e["x-attribsNamespace"])),e["x-attribsPrefix"]&&(o["x-attribsPrefix"]=__assign({},e["x-attribsPrefix"])),n=o}else if(isCDATA(e)){r=t?cloneChildren(e.children):[];var i=new CDATA(r);r.forEach((function(e){return e.parent=i})),n=i}else if(isDocument(e)){r=t?cloneChildren(e.children):[];var s=new Document(r);r.forEach((function(e){return e.parent=s})),e["x-mode"]&&(s["x-mode"]=e["x-mode"]),n=s}else{if(!isDirective(e))throw new Error("Not implemented yet: ".concat(e.type));var u=new ProcessingInstruction(e.name,e.data);null!=e["x-name"]&&(u["x-name"]=e["x-name"],u["x-publicId"]=e["x-publicId"],u["x-systemId"]=e["x-systemId"]),n=u}return n.startIndex=e.startIndex,n.endIndex=e.endIndex,null!=e.sourceCodeLocation&&(n.sourceCodeLocation=e.sourceCodeLocation),n}function cloneChildren(e){for(var t=e.map((function(e){return cloneNode(e,!0)})),n=1;n<t.length;n++)t[n].prev=t[n-1],t[n-1].next=t[n];return t}exports.Element=Element,exports.isTag=isTag,exports.isCDATA=isCDATA,exports.isText=isText,exports.isComment=isComment,exports.isDirective=isDirective,exports.isDocument=isDocument,exports.hasChildren=hasChildren,exports.cloneNode=cloneNode;
